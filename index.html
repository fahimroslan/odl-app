<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ODL Academic Ops Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light;
        --bg: #ffffff;
        --surface: #ffffff;
        --surface-2: #f6f8fb;
        --ink: #101418;
        --muted: #5f6b7a;
        --accent: #1d4ed8;
        --accent-2: #0f766e;
        --border: rgba(16, 20, 24, 0.12);
        --shadow: 0 12px 28px rgba(16, 20, 24, 0.08);
        --radius: 16px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Manrope", "Segoe UI", sans-serif;
        color: var(--ink);
        background: var(--bg);
        min-height: 100vh;
      }

      .shell {
        max-width: 1240px;
        margin: 0 auto;
        padding: 32px 24px 64px;
        position: relative;
      }

      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        flex-wrap: wrap;
        margin-bottom: 22px;
      }

      .title {
        font-family: "Space Grotesk", "Segoe UI", sans-serif;
        font-size: clamp(26px, 3.4vw, 36px);
        letter-spacing: -0.02em;
        margin: 0;
      }

      .subtitle {
        color: var(--muted);
        margin: 6px 0 0;
        font-size: 14px;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .btn {
        appearance: none;
        border: 1px solid transparent;
        background: var(--accent);
        color: #fff;
        font-weight: 600;
        padding: 10px 18px;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 20px rgba(29, 78, 216, 0.2);
      }

      .btn.secondary {
        background: #fff;
        border-color: var(--border);
        color: var(--ink);
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(12, minmax(0, 1fr));
        gap: 16px;
      }

      .tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 8px 0 20px;
      }

      .tab-btn {
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--ink);
        padding: 8px 16px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .tab-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 16px rgba(16, 20, 24, 0.12);
      }

      .tab-btn.active {
        background: var(--accent);
        color: #fff;
        border-color: transparent;
      }

      .tab-panel {
        display: none;
      }

      .tab-panel.active {
        display: block;
      }

      .result-subtab-panel {
        display: none;
      }

      .result-subtab-panel.active {
        display: block;
      }

      .enrollment-subtab-panel {
        display: none;
      }

      .enrollment-subtab-panel.active {
        display: block;
      }

      .card {
        background: var(--surface);
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .stat {
        grid-column: span 3;
        display: flex;
        flex-direction: column;
        gap: 10px;
        min-height: 140px;
      }

      .stat h3 {
        margin: 0;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--muted);
      }

      .stat .value {
        font-family: "Space Grotesk", "Segoe UI", sans-serif;
        font-size: clamp(26px, 3vw, 36px);
        font-weight: 700;
      }

      .stat .trend {
        font-size: 13px;
        color: var(--muted);
      }

      .import-card {
        grid-column: span 4;
      }

      .table-card {
        grid-column: span 8;
      }

      .card-title {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
      }

      .card-title h2 {
        font-size: 18px;
        margin: 0;
      }

      .chip {
        background: var(--surface-2);
        border: 1px solid var(--border);
        padding: 4px 10px;
        border-radius: 10px;
        font-size: 12px;
        color: var(--muted);
      }

      .chip.new-tag {
        background: rgba(15, 118, 110, 0.12);
        border-color: rgba(15, 118, 110, 0.35);
        color: var(--accent-2);
        font-weight: 600;
        margin-left: 8px;
      }

      .import-row {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 10px;
      }

      input[type="file"] {
        padding: 10px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: #fff;
        flex: 1 1 220px;
      }

      .muted {
        color: var(--muted);
        font-size: 13px;
        margin: 8px 0 14px;
      }

      pre {
        background: var(--surface-2);
        padding: 12px;
        border-radius: 12px;
        overflow: auto;
        min-height: 120px;
        font-size: 12px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
      }

      .slip-table {
        table-layout: fixed;
        width: 100%;
      }

      .slip-table td,
      .slip-table th {
        vertical-align: top;
      }

      .slip-table th {
        white-space: normal;
        line-height: 1.2;
      }

      .slip-table td {
        word-break: break-word;
      }

      th,
      td {
        padding: 10px 8px;
        text-align: left;
        border-bottom: 1px solid rgba(16, 20, 24, 0.08);
      }

      th {
        color: var(--muted);
        font-weight: 600;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      th.sortable {
        cursor: pointer;
        user-select: none;
      }

      tfoot td {
        font-size: 11px;
        color: var(--muted);
        border-bottom: none;
        padding-top: 6px;
      }

      tfoot td strong {
        color: var(--ink);
        font-weight: 600;
      }

      .course-card {
        grid-column: span 12;
      }

      .course-stat {
        grid-column: span 6;
        min-height: 120px;
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(12, minmax(0, 1fr));
        gap: 12px;
        margin-bottom: 12px;
      }

      .field {
        grid-column: span 3;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .field-wide {
        grid-column: span 6;
      }

      .field label {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--muted);
      }

      .field input,
      .field select {
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid var(--border);
        font-size: 14px;
        font-family: inherit;
        background: #fff;
      }

      .preview-action-select {
        padding: 6px 8px;
        border-radius: 8px;
        border: 1px solid var(--border);
        font-size: 12px;
        background: #fff;
      }

      .form-actions {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 12px;
      }

      .btn.small {
        padding: 6px 12px;
        font-size: 12px;
      }

      .table-actions {
        white-space: nowrap;
      }

      .table-actions .btn + .btn {
        margin-left: 8px;
      }

      .meter {
        height: 8px;
        background: #eef1f6;
        border-radius: 999px;
        overflow: hidden;
      }

      .meter > span {
        display: block;
        height: 100%;
        background: linear-gradient(120deg, var(--accent), var(--accent-2));
      }

      .results-grid {
        display: grid;
        grid-template-columns: repeat(12, minmax(0, 1fr));
        gap: 18px;
      }

      .filter-row {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .filter-row .field {
        min-width: 200px;
      }

      .result-table td.fail,
      .result-table .remark,
      .fail,
      .remark {
        color: #b42318;
        font-weight: 600;
      }

      .link-button {
        background: none;
        border: none;
        padding: 0;
        color: var(--accent);
        cursor: pointer;
        font: inherit;
      }

      .link-button:hover {
        text-decoration: underline;
      }

      .student-inline-row td {
        padding: 0;
        border-bottom: none;
      }

      .inline-editor {
        margin: 8px 0 16px;
        padding: 14px;
        border-radius: 12px;
        background: var(--surface-2);
        border: 1px solid var(--border);
      }

      .result-inline-row td {
        padding: 0;
        border-bottom: none;
      }

      .result-inline-panel {
        margin: 8px 0 16px;
        padding: 14px;
        border-radius: 12px;
        background: var(--surface-2);
        border: 1px solid var(--border);
      }

      .result-inline-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 8px;
      }

      .result-inline-summary {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        font-size: 12px;
        color: var(--muted);
        margin-bottom: 10px;
      }

      .result-inline-table {
        font-size: 13px;
        table-layout: fixed;
        width: 100%;
      }

      .result-inline-table th {
        font-size: 11px;
      }

      .result-inline-table th,
      .result-inline-table td {
        text-align: left;
      }

      .result-inline-table th:nth-child(3),
      .result-inline-table td:nth-child(3) {
        text-align: right;
        padding-right: 4px;
      }

      .result-inline-table th:nth-child(4),
      .result-inline-table td:nth-child(4) {
        text-align: center;
      }

      .result-inline-table th:nth-child(6),
      .result-inline-table td:nth-child(6) {
        text-align: right;
      }

      .result-inline-section {
        margin-top: 10px;
      }

      .result-inline-section h4 {
        margin: 8px 0;
        font-size: 13px;
      }

      .mark-input {
        width: 86px;
        padding: 6px 8px;
        border-radius: 8px;
        border: 1px solid var(--border);
        font: inherit;
        font-size: 13px;
      }

      .mark-edit-grid {
        display: grid;
        grid-template-columns: repeat(12, minmax(0, 1fr));
        gap: 12px;
        margin-top: 8px;
      }

      .mark-edit-row {
        grid-column: span 6;
        display: grid;
        gap: 6px;
      }

      .mark-edit-row span {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--muted);
      }

      .mark-edit-row strong {
        font-size: 14px;
      }

      .mark-edit-input {
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid var(--border);
        font-size: 14px;
        font-family: inherit;
        background: #fff;
      }

      .mark-edit-warning {
        margin-top: 10px;
        font-size: 12px;
        color: #b42318;
      }

      .mark-edit-verify {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 12px;
        font-size: 13px;
        color: var(--muted);
      }

      .enrollment-course-grid {
        display: grid;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        gap: 8px;
        padding: 2px;
      }

      .enrollment-course-item {
        appearance: none;
        width: 100%;
        text-align: left;
        display: grid;
        gap: 4px;
        padding: 9px 10px;
        border: 1px solid var(--border);
        border-radius: 8px;
        background: #fff;
        cursor: pointer;
        font: inherit;
      }

      .enrollment-key-label {
        font-size: 11px;
        color: var(--muted);
      }

      .enrollment-key-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 4px;
      }

      .enrollment-top-actions {
        margin-top: 8px;
      }

      .enrollment-key-bulk-actions {
        margin-top: 8px;
      }

      .enrollment-key-btn {
        padding: 4px 8px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: var(--surface-2);
        font-size: 11px;
        cursor: pointer;
      }

      .enrollment-key-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .enrollment-course-item.selected .enrollment-key-label,
      .enrollment-course-item.selected .enrollment-key-btn {
        color: rgba(255, 255, 255, 0.9);
        border-color: rgba(255, 255, 255, 0.5);
        background: rgba(255, 255, 255, 0.15);
      }

      .enrollment-course-item.selected {
        border-color: var(--accent);
        background: var(--accent);
        color: #fff;
      }

      .enrollment-course-item strong {
        display: block;
        font-size: 13px;
      }

      .enrollment-course-item span {
        display: block;
        font-size: 12px;
        color: var(--muted);
        margin-top: 2px;
      }

      .enrollment-course-item.selected span {
        color: rgba(255, 255, 255, 0.86);
      }

      .enrollment-course-item.priority {
        border-color: #f97316;
        background: #fff7ed;
        color: #9a3412;
      }

      .enrollment-course-item.priority.selected {
        background: linear-gradient(120deg, #f97316, #ea580c);
        border-color: #f97316;
        color: #fff;
      }

      .enrollment-course-item.priority .enrollment-key-label,
      .enrollment-course-item.priority .enrollment-key-btn {
        color: #9a3412;
        border-color: rgba(249, 115, 22, 0.45);
        background: rgba(249, 115, 22, 0.12);
      }

      .enrollment-course-item.priority.selected .enrollment-key-label,
      .enrollment-course-item.priority.selected .enrollment-key-btn {
        color: rgba(255, 255, 255, 0.9);
        border-color: rgba(255, 255, 255, 0.5);
        background: rgba(255, 255, 255, 0.15);
      }

      .enrollment-custom-list {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
        margin-top: 10px;
      }

      .enrollment-custom-item {
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 10px 12px;
        background: #fff;
      }

      .enrollment-custom-item label {
        display: grid;
        gap: 4px;
        cursor: pointer;
      }

      .enrollment-custom-item strong {
        font-size: 13px;
      }

      .enrollment-custom-item .muted {
        margin: 0;
      }

      .enrollment-inline-row td {
        padding: 0;
        border-bottom: none;
      }

      .enrollment-inline-panel {
        margin: 8px 0 16px;
        padding: 14px;
        border-radius: 12px;
        background: var(--surface-2);
        border: 1px solid var(--border);
      }

      .enrollment-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 12px;
      }

      .enrollment-grid-col {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 10px;
        border-radius: 12px;
        border: 1px solid var(--border);
      }

      .enrollment-grid-header {
        font-weight: 600;
        font-size: 13px;
      }

      .enrollment-chip-list {
        display: grid;
        gap: 6px;
      }

      .enrollment-chip {
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 8px 10px;
        background: #fff;
        display: grid;
        gap: 2px;
      }

      .enrollment-chip.compact {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 999px;
      }

      .enrollment-grid-col.passed {
        background: rgba(22, 163, 74, 0.08);
        border-color: rgba(22, 163, 74, 0.35);
      }

      .enrollment-grid-col.enrolled {
        background: rgba(14, 116, 144, 0.08);
        border-color: rgba(14, 116, 144, 0.35);
      }

      .enrollment-grid-col.pending {
        background: rgba(234, 88, 12, 0.08);
        border-color: rgba(234, 88, 12, 0.35);
      }

      .filter-chip-group {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .filter-chip {
        border: 1px solid var(--border);
        background: #fff;
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 12px;
        cursor: pointer;
      }

      .filter-chip.active {
        background: var(--accent);
        border-color: var(--accent);
        color: #fff;
      }

      .flag-tag {
        background: #fee2e2;
        color: #b42318;
        border: 1px solid rgba(180, 35, 24, 0.35);
        margin-left: 6px;
      }

      .lock-tag {
        background: rgba(37, 99, 235, 0.12);
        color: #1d4ed8;
        border: 1px solid rgba(29, 78, 216, 0.35);
        margin-left: 6px;
      }

      .inline-toggle {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 6px;
        font-size: 12px;
      }

      .inline-toggle label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .enrollment-course-grid.disabled {
        opacity: 0.55;
        pointer-events: none;
      }

      .enrollment-chip strong {
        font-size: 12px;
      }

      .enrollment-chip span {
        font-size: 12px;
      }

      .enrollment-chip.compact span {
        display: none;
      }

      .app-footer {
        margin-top: 40px;
        padding: 18px 0 6px;
        text-align: center;
        font-size: 12px;
        color: var(--muted);
        border-top: 1px solid var(--border);
      }

      @media (max-width: 720px) {
        .enrollment-custom-list {
          grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .enrollment-grid {
          grid-template-columns: repeat(1, minmax(0, 1fr));
        }
      }

      .enrollment-layout {
        display: grid;
        grid-template-columns: repeat(12, minmax(0, 1fr));
        gap: 16px;
      }

      .enrollment-list-card {
        grid-column: span 12;
      }


      .slip {
        background: var(--surface-2);
        border-radius: var(--radius);
        padding: 20px;
        border: 1px solid var(--border);
      }

      .slip-header {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 16px;
      }

      .slip-actions {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        margin-bottom: 12px;
      }

      .slip-indicators {
        display: inline-flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
      }

      .slip-indicator {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        color: var(--muted);
      }

      .slip-indicator .label {
        display: none;
      }

      .slip-indicator:hover .label {
        display: inline;
      }

      .slip-indicator.lock {
        color: #1d4ed8;
      }

      .slip-indicator.flag {
        color: #b42318;
      }

      .slip-brand {
        display: grid;
        gap: 4px;
        font-size: 13px;
        color: var(--muted);
      }

      .slip-brand strong {
        font-size: 16px;
        color: var(--ink);
      }

      .slip-title {
        font-family: "Space Grotesk", "Segoe UI", sans-serif;
        font-size: 22px;
        margin: 0;
      }

      .slip-meta {
        display: grid;
        gap: 4px;
        font-size: 13px;
        color: var(--muted);
      }

      .slip-meta table {
        font-size: 13px;
        width: auto;
      }

      .slip-meta td {
        border-bottom: none;
        padding: 4px 10px 4px 0;
        color: var(--ink);
      }

      .slip-meta td span {
        color: var(--muted);
      }

      .slip-section {
        margin-top: 18px;
      }

      .slip-section h4 {
        margin: 0 0 8px;
        font-size: 16px;
      }

      .slip-disclaimer {
        margin-top: 16px;
        font-size: 12px;
        color: var(--muted);
        border-top: 1px solid var(--border);
        padding-top: 10px;
      }

      .slip-disclaimer strong {
        color: var(--ink);
      }

      .gpa-tag {
        background: #fff;
        border: 1px solid var(--border);
        padding: 6px 12px;
        border-radius: 10px;
        font-weight: 600;
        font-size: 12px;
        color: var(--ink);
      }

      .modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 24px;
        background: rgba(28, 27, 31, 0.6);
        z-index: 1000;
      }

      .modal.active {
        display: flex;
      }

      .modal-card {
        width: min(960px, 96vw);
        max-height: 90vh;
        overflow: auto;
        background: var(--surface);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .modal-header {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 16px;
      }

      .drawer {
        position: fixed;
        inset: 0;
        display: none;
        justify-content: flex-end;
        background: rgba(28, 27, 31, 0.5);
        z-index: 1100;
      }

      .drawer.active {
        display: flex;
      }

      .drawer-panel {
        width: min(420px, 92vw);
        height: 100%;
        background: var(--surface);
        border-left: 1px solid var(--border);
        box-shadow: var(--shadow);
        padding: 20px;
        overflow-y: auto;
      }

      .drawer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 16px;
      }

      .drawer-section {
        margin-bottom: 16px;
      }

      .drawer-section h4 {
        margin: 0 0 8px;
      }

      @media print {
        @page {
          size: A4 portrait;
          margin: 12mm;
        }

        body {
          background: #fff;
          margin: 0;
          font-size: 11px;
        }

        .shell,
        .tabs,
        header,
        #panel-dashboard,
        #panel-data,
        #panel-courses,
        #panel-enrollment,
        #panel-results,
        #courseCoverageModal,
        #studentProfileDrawer,
        #resultPreviewModal,
        #studentImportPreviewModal,
        #studentEditModal,
        #markEditModal {
          display: none !important;
        }

        #resultSlipModal,
        #enrollmentSlipModal {
          position: static;
          display: none;
          padding: 0;
          background: none;
        }

        body[data-print-mode="result"] #resultSlipModal,
        body[data-print-mode="enrollment"] #enrollmentSlipModal {
          display: block;
        }

        #resultSlipModal .modal-card,
        #enrollmentSlipModal .modal-card {
          width: 100%;
          max-height: none;
          overflow: visible;
          box-shadow: none;
          border: none;
          padding: 0;
        }

        #resultSlip,
        #enrollmentSlip {
          position: static;
          width: 100%;
        }

        .slip-indicator .label {
          display: inline;
        }

        .slip {
          box-shadow: none;
          border: none;
          background: #fff;
          padding: 0;
        }

        .slip-title {
          font-size: 18px;
        }

        .slip-brand {
          font-size: 11px;
        }

        .slip-brand strong {
          font-size: 13px;
        }

        .gpa-tag {
          font-size: 11px;
        }

          .slip-actions,
          .modal-header .form-actions {
            display: none;
          }

          #enrollmentCustomSection {
            display: none;
          }

          .slip-section {
            margin-top: 10px;
          }

        .slip-disclaimer {
          font-size: 10px;
        }

        table {
          font-size: 11px;
          page-break-inside: auto;
        }

        th,
        td {
          padding: 6px 6px;
        }

        tr {
          page-break-inside: avoid;
          page-break-after: auto;
        }

        .slip-section {
          page-break-inside: auto;
        }
      }

      .empty {
        padding: 28px;
        text-align: center;
        color: var(--muted);
        background: var(--surface-2);
        border-radius: 16px;
        border: 1px dashed var(--border);
      }

      .fade-up {
        animation: fadeUp 0.6s ease both;
      }

      .delay-1 { animation-delay: 0.05s; }
      .delay-2 { animation-delay: 0.1s; }
      .delay-3 { animation-delay: 0.15s; }
      .delay-4 { animation-delay: 0.2s; }

      @keyframes fadeUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @media (max-width: 1024px) {
        .stat { grid-column: span 6; }
        .import-card, .table-card { grid-column: span 12; }
        .enrollment-list-card { grid-column: span 12; }
        .enrollment-course-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .field, .field-wide { grid-column: span 12; }
      }

      @media (max-width: 720px) {
        header { align-items: flex-start; }
        .stat { grid-column: span 12; }
        .enrollment-course-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      }
    </style>

    <!-- CSV parser (client-side). Keep it simple for MVP -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  </head>
  <body>
    <div class="shell">
      <header class="fade-up">
        <div>
          <h1 class="title">ODL Academic Ops</h1>
          <p class="subtitle">Dashboard snapshot for students, courses, and engagement coverage.</p>
        </div>
        <div class="header-actions">
          <span class="chip" id="lastUpdated">Last updated: --</span>
          <button class="btn secondary" id="btnRefresh">Refresh stats</button>
        </div>
      </header>

      <nav class="tabs" role="tablist" aria-label="ODL modules">
        <button class="tab-btn active" type="button" role="tab" aria-selected="true" data-tab="dashboard">
          Dashboard
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="data">
          Data
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="courses">
          Courses
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="students">
          Students
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="results">
          Results
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="enrollment">
          Enrollment
        </button>
        <button class="tab-btn" type="button" role="tab" aria-selected="false" data-tab="reporting">
          Reporting
        </button>
      </nav>

      <section class="tab-panel active" id="panel-dashboard" role="tabpanel">
        <div class="grid">
          <div class="card stat fade-up delay-1">
            <h3>Total Students</h3>
            <div class="value" id="totalStudents">--</div>
            <div class="trend">Indexed in the current database</div>
          </div>
          <div class="card stat fade-up delay-2">
            <h3>Total Courses</h3>
            <div class="value" id="totalCourses">--</div>
            <div class="trend">Unique courses in catalog</div>
          </div>
          <div class="card stat fade-up delay-3">
            <h3>Active Courses</h3>
            <div class="value" id="activeCourses">--</div>
            <div class="trend">Courses with recorded results</div>
          </div>
          <div class="card stat fade-up delay-4">
            <h3>Total Results</h3>
            <div class="value" id="totalResults">--</div>
            <div class="trend">Student course outcomes</div>
          </div>

          <div class="card stat fade-up delay-1">
            <h3>Active Students</h3>
            <div class="value" id="activeStudents">--</div>
            <div class="trend">Students with results</div>
          </div>
          <div class="card stat fade-up delay-2">
            <h3>Students w/ Failures</h3>
            <div class="value" id="studentsWithFailures">--</div>
            <div class="trend">Any failed course</div>
            <button class="btn secondary small" type="button" id="btnViewFailures">View list</button>
          </div>
          <div class="card stat fade-up delay-3">
            <h3>Incomplete Student Info</h3>
            <div class="value" id="studentsIncomplete">--</div>
            <div class="trend">Missing IC or ID</div>
            <button class="btn secondary small" type="button" id="btnViewIncomplete">View list</button>
          </div>
          <div class="card stat fade-up delay-4">
            <h3>Students w/ CGPA &lt; 2.00</h3>
            <div class="value" id="studentsLowCgpa">--</div>
            <div class="trend">Calculated from results</div>
            <button class="btn secondary small" type="button" id="btnViewLowCgpa">View list</button>
          </div>
          <div class="card stat fade-up delay-1">
            <h3>Result Issues</h3>
            <div class="value" id="studentsResultIssues">--</div>
            <div class="trend">Repeated course or missing mark</div>
            <button class="btn secondary small" type="button" id="btnViewResultIssues">View list</button>
          </div>
          <div class="card stat fade-up delay-3">
            <h3>Avg Results / Student</h3>
            <div class="value" id="avgResultsPerStudent">--</div>
            <div class="trend">Across all students</div>
          </div>

          <div class="card table-card fade-up delay-3">
            <div class="card-title">
              <h2>Overview</h2>
              <span class="chip">Key metrics</span>
            </div>
            <div class="muted">
              Use the Courses tab to review coverage and student lists per course.
            </div>
          </div>
        </div>
      </section>

      <section class="tab-panel" id="panel-courses" role="tabpanel">
        <div class="grid">
          <div class="card stat course-stat fade-up delay-2">
            <h3>Total Courses</h3>
            <div class="value" id="courseTotalCount">--</div>
            <div class="trend">Courses in the catalog</div>
          </div>
          <div class="card stat course-stat fade-up delay-3">
            <h3>Total Credits</h3>
            <div class="value" id="courseTotalCredits">--</div>
            <div class="trend">Sum of all course credits</div>
          </div>

          <div class="card course-card fade-up delay-4">
            <div class="card-title">
              <h2>Course Catalog</h2>
              <span class="chip">Add & Update</span>
            </div>
            <form id="courseForm">
              <div class="form-grid">
                <div class="field">
                  <label for="courseCode">Course Code</label>
                  <input id="courseCode" name="courseCode" type="text" placeholder="e.g. MPU3123" required />
                </div>
                <div class="field field-wide">
                  <label for="courseTitle">Title</label>
                  <input id="courseTitle" name="courseTitle" type="text" placeholder="Course title" />
                </div>
                <div class="field">
                  <label for="courseCredits">Credits</label>
                  <input id="courseCredits" name="courseCredits" type="number" min="0" step="1" placeholder="0" />
                </div>
                <div class="field">
                  <label for="courseMPU">MPU Course</label>
                  <select id="courseMPU" name="courseMPU">
                    <option value="">Unknown</option>
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                  </select>
                </div>
              </div>
              <div class="form-actions">
                <button class="btn" type="submit" id="btnCourseSave">Save Course</button>
                <button class="btn secondary" type="button" id="btnCourseReset">Reset</button>
                <span class="muted" id="courseFormHint">Use the same course code to update an existing course.</span>
              </div>
            </form>

            <div id="courseListEmpty" class="empty" style="margin-top: 16px;">
              No courses yet. Add a course or import a catalog.
            </div>
            <table id="courseListTable" style="display: none; margin-top: 16px;">
              <thead>
                <tr>
                  <th>Code</th>
                  <th>Title</th>
                  <th>Coverage</th>
                  <th>Credits</th>
                  <th>MPU</th>
                  <th>Action</th>
                  <th>View List</th>
                </tr>
              </thead>
              <tbody id="courseListBody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="tab-panel" id="panel-data" role="tabpanel">
        <div class="grid">
          <div class="card import-card fade-up delay-2" style="grid-column: span 6;">
            <div class="card-title">
              <h2>Import Results CSV</h2>
              <span class="chip">CSV</span>
            </div>
            <div class="import-row">
              <input type="file" id="csvFileImports" accept=".csv" />
              <button class="btn" id="btnImportImports">Import</button>
            </div>
            <p class="muted">
              Expected columns include: ID, Name, IC, Intake, CourseCode, Title, Credits, Session,
              Semester, Mark, Letter, Point, GradePoints, PassedCourse, CreditsEarned.
            </p>
            <h3 class="card-title" style="margin-top: 10px;"><span>Log</span></h3>
            <pre id="logImports"></pre>
          </div>

          <div class="card import-card fade-up delay-2" style="grid-column: span 6;">
            <div class="card-title">
              <h2>Import Students CSV</h2>
              <span class="chip">Bulk Register</span>
            </div>
            <div class="import-row">
                <input type="file" id="studentCsvFile" accept=".csv" />
                <button class="btn" id="btnImportStudents">Import</button>
              </div>
              <p class="muted">
                Required columns: StudentID, Name, Intake (YYYY/MM). Optional: IC.
                Import opens a preview popup to confirm New / Duplicate rows and choose Update or Skip for
              duplicate-name conflicts.
            </p>
            <div class="muted">
              Example template: <a href="./example-students.csv" download>Download example-students.csv</a>
            </div>
            <h3 class="card-title" style="margin-top: 10px;"><span>Log</span></h3>
            <pre id="studentImportLog"></pre>
          </div>

          <div class="card fade-up delay-2" style="grid-column: span 6;">
            <div class="card-title">
              <h2>Upload New Results</h2>
              <span class="chip">CSV</span>
            </div>
            <div class="import-row">
              <select id="newResultYear" aria-label="Session year">
                <option value="">Year</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
              </select>
              <select id="newResultMonth" aria-label="Session month">
                <option value="">Month</option>
                <option value="02">02</option>
                <option value="09">09</option>
              </select>
              <select id="newResultCourse" aria-label="Course">
                <option value="">Course</option>
              </select>
              <input type="file" id="newResultFile" accept=".csv" />
              <button class="btn secondary" id="btnPreviewResults">Preview</button>
              <button class="btn" id="btnUploadNewResults">Upload</button>
            </div>
            <p class="muted">
              Expected columns: Student ID, Full Name, Mark. Session format is YYYY/MM (month 02 or 09).
            </p>
            <div class="muted">
              Example template: <a href="./example.csv" download>Download example.csv</a>
            </div>
            <h3 class="card-title" style="margin-top: 10px;"><span>Upload Log</span></h3>
            <pre id="newResultLog"></pre>
          </div>

          <div class="card fade-up delay-2" style="grid-column: span 12;">
            <div class="card-title">
              <h2>Backup &amp; Restore</h2>
              <span class="chip">CSV</span>
            </div>
            <div class="import-row">
              <button class="btn" id="btnBackupDownload">Download Backup CSV</button>
            </div>
            <p class="muted">
              This backup uses the same columns as Import Results CSV.
            </p>
            <div class="import-row">
              <input type="file" id="backupFile" accept=".csv" />
              <button class="btn secondary" id="btnBackupImport">Restore from CSV</button>
            </div>
            <p class="muted">
              You can also restore via the Data tab using the same CSV.
            </p>
            <h3 class="card-title" style="margin-top: 10px;"><span>Backup Log</span></h3>
            <pre id="backupLog"></pre>
          </div>

          <div class="card fade-up delay-2" style="grid-column: span 12;">
            <div class="card-title">
              <h2>Portal Export</h2>
              <span class="chip">JSON</span>
            </div>
            <div class="import-row">
              <input
                type="text"
                id="portalUploadUrl"
                value="http://localhost:5179/api/admin/import-portal-export"
                aria-label="Portal upload URL"
                style="flex: 1 1 360px;"
              />
              <button class="btn secondary" type="button" id="btnPortalUpload">Upload to Portal</button>
            </div>
            <p class="muted">
              Generates a JSON package for the student portal (students, courses, results, metadata).
            </p>
            <h3 class="card-title" style="margin-top: 10px;"><span>Export Log</span></h3>
            <pre id="portalExportLog"></pre>
          </div>
        </div>
      </section>

      <section class="tab-panel" id="panel-students" role="tabpanel">
        <div class="grid">
          <div class="card fade-up delay-2" style="grid-column: span 12;">
              <div class="card-title">
                <h2>Student List</h2>
                <span class="chip">Slip Access</span>
              </div>
              <div class="form-actions" style="margin-bottom: 12px;">
                <button class="btn secondary small" type="button" id="btnConfirmResultSlips">
                  Confirm Result Slips
                </button>
                <span class="chip" id="resultSlipConfirmStatus">Result: Not confirmed</span>
                <button class="btn secondary small" type="button" id="btnConfirmEnrollmentSlips">
                  Confirm Enrollment Slips
                </button>
                <span class="chip" id="enrollmentSlipConfirmStatus">Enrollment: Not confirmed</span>
              </div>
              <div class="filter-row" style="margin-bottom: 12px;">
                <div class="field field-wide">
                  <label for="studentListSearch">Search</label>
                  <input id="studentListSearch" type="search" placeholder="Search by Student ID or Name" />
                </div>
                <div class="field">
                  <label for="studentListIntake">Intake</label>
                  <select id="studentListIntake">
                    <option value="">All intakes</option>
                  </select>
                </div>
                <div class="field">
                  <label for="studentListStatus">Status</label>
                  <select id="studentListStatus">
                    <option value="">All statuses</option>
                    <option value="new">New only</option>
                    <option value="has-results">Has results</option>
                  </select>
                </div>
              </div>
              <div id="studentListEmpty" class="empty">No students yet. Import results or students to begin.</div>
              <table id="studentListTable" style="display: none; margin-top: 12px;">
                <thead>
                  <tr>
                    <th>Student ID</th>
                    <th>Name</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="studentListBody"></tbody>
              </table>
              <div class="form-actions" id="studentListPager" style="display: none; margin-top: 12px;">
                <button class="btn secondary small" type="button" id="btnStudentListPrev">Previous</button>
                <span class="muted" id="studentListPageMeta">Page 1 of 1</span>
                <button class="btn secondary small" type="button" id="btnStudentListNext">Next</button>
              </div>
            </div>
          </div>
        </section>

      <section class="tab-panel" id="panel-results" role="tabpanel">
        <div class="tabs" role="tablist" aria-label="Results subtabs">
          <button class="tab-btn active result-subtab-btn" type="button" role="tab" aria-selected="true" data-subtab="overview">
            Overview
          </button>
          <button class="tab-btn result-subtab-btn" type="button" role="tab" aria-selected="false" data-subtab="listing">
            Result Listing
          </button>
          <button class="tab-btn result-subtab-btn" type="button" role="tab" aria-selected="false" data-subtab="issues">
            Student Issues
          </button>
        </div>

        <div class="result-subtab-panel active" id="result-subtab-overview" role="tabpanel">
          <div class="results-grid">
            <div class="card stat fade-up delay-1">
              <h3>Total Results</h3>
              <div class="value" id="resultTotal">--</div>
              <div class="trend">Records for current filters</div>
            </div>
            <div class="card stat fade-up delay-2">
              <h3>Pass Rate</h3>
              <div class="value" id="resultPassRate">--</div>
              <div class="trend">Based on passed courses</div>
            </div>
            <div class="card stat fade-up delay-3">
              <h3>Avg Mark</h3>
              <div class="value" id="resultAvgMark">--</div>
              <div class="trend">Across filtered results</div>
            </div>
            <div class="card stat fade-up delay-4">
              <h3>Students</h3>
              <div class="value" id="resultStudents">--</div>
              <div class="trend">Distinct in selection</div>
            </div>
          </div>
        </div>

        <div class="result-subtab-panel" id="result-subtab-listing" role="tabpanel">
          <div class="results-grid">
            <div class="card fade-up delay-2" style="grid-column: span 12;">
              <div class="card-title">
                <h2>Results Filters</h2>
                <span class="chip">Intake + Search</span>
              </div>
              <div class="filter-row">
                <div class="field">
                  <label for="resultViewMode">View</label>
                  <select id="resultViewMode">
                    <option value="students">By Student</option>
                    <option value="courses">By Course</option>
                  </select>
                </div>
                <div class="field">
                  <label for="resultSessionSelect">Intake</label>
                  <select id="resultSessionSelect">
                    <option value="">All intakes</option>
                  </select>
                </div>
                <div class="field field-wide">
                  <label for="resultSearch">Search</label>
                  <input id="resultSearch" type="text" placeholder="Search by student name or ID" />
                </div>
              </div>
            </div>

            <div class="card fade-up delay-3" style="grid-column: span 12;">
              <div class="card-title">
                <h2>Result Listing</h2>
                <span class="chip">Filtered</span>
              </div>
              <div class="form-actions" id="courseDetailHeader" style="display: none; margin-bottom: 12px;">
                <button class="btn secondary small" type="button" id="btnBackToCourseList">Back to course list</button>
                <span class="chip" id="courseDetailTitle">Course</span>
              </div>
              <div id="courseDetailStats" class="grid" style="display: none; margin-bottom: 12px;">
                <div class="card stat">
                  <h3>Course Records</h3>
                  <div class="value" id="courseDetailRecords">--</div>
                  <div class="trend">Total results for course</div>
                </div>
                <div class="card stat">
                  <h3>Pass Rate</h3>
                  <div class="value" id="courseDetailPassRate">--</div>
                  <div class="trend">Based on passed courses</div>
                </div>
                <div class="card stat">
                  <h3>Avg Mark</h3>
                  <div class="value" id="courseDetailAvgMark">--</div>
                  <div class="trend">Across course results</div>
                </div>
                <div class="card stat">
                  <h3>Unique Students</h3>
                  <div class="value" id="courseDetailStudents">--</div>
                  <div class="trend">In this course</div>
                </div>
              </div>
              <div id="resultTableEmpty" class="empty">No results yet. Import results to begin.</div>
              <table id="resultTable" class="result-table" style="display: none;">
                <thead>
                  <tr>
                    <th>Student</th>
                    <th>Course</th>
                    <th>Session</th>
                    <th>Semester</th>
                    <th>Mark</th>
                    <th>Letter</th>
                    <th>Point</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="resultTableBody"></tbody>
              </table>
              <div class="form-actions" id="resultPager" style="display: none; margin-top: 12px;">
                <button class="btn secondary small" type="button" id="btnPrevPage">Previous</button>
                <span class="muted" id="resultPageMeta">Page 1 of 1</span>
                <button class="btn secondary small" type="button" id="btnNextPage">Next</button>
              </div>
            </div>
          </div>
        </div>

        <div class="result-subtab-panel" id="result-subtab-issues" role="tabpanel">
          <div class="results-grid">
            <div class="card fade-up delay-4" style="grid-column: span 12;">
              <div class="card-title">
                <h2>Student Issues</h2>
                <span class="chip">Review &amp; Resolve</span>
              </div>
              <div class="filter-row">
                <div class="field">
                  <label for="issueTypeSelect">Issue Type</label>
                  <select id="issueTypeSelect">
                    <option value="failures">Students with failures</option>
                    <option value="incomplete">Incomplete student info</option>
                    <option value="lowCgpa">CGPA below 2.00</option>
                    <option value="resultIssues">Result issues (repeated course / missing mark)</option>
                  </select>
                </div>
                <div class="field field-wide">
                  <label for="issueSearch">Search</label>
                  <input id="issueSearch" type="text" placeholder="Search by student name or ID" />
                </div>
              </div>
              <div class="card-title" style="margin-top: 16px;">
                <h2 id="issueListTitle">Student List</h2>
                <span class="chip" id="issueListCount">0</span>
              </div>
              <div id="issueListEmpty" class="empty">No students found.</div>
              <table id="issueListTable" style="display: none;">
                <thead>
                  <tr>
                    <th>Student ID</th>
                    <th>Name</th>
                    <th>IC</th>
                    <th>Intake</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="issueListBody"></tbody>
              </table>
              <div class="form-actions" id="issuePager" style="display: none; margin-top: 12px;">
                <button class="btn secondary small" type="button" id="btnIssuePrev">Previous</button>
                <span class="muted" id="issuePageMeta">Page 1 of 1</span>
                <button class="btn secondary small" type="button" id="btnIssueNext">Next</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="tab-panel" id="panel-enrollment" role="tabpanel">
          <div class="tabs" role="tablist" aria-label="Enrollment subtabs">
            <button class="tab-btn active enrollment-subtab-btn" type="button" role="tab" aria-selected="true" data-enrollment-subtab="listing">
              Enrollment List
            </button>
            <button class="tab-btn enrollment-subtab-btn" type="button" role="tab" aria-selected="false" data-enrollment-subtab="stats">
              Enrollment Stats
            </button>
            <button class="tab-btn enrollment-subtab-btn" type="button" role="tab" aria-selected="false" data-enrollment-subtab="flags">
              Red Flags
            </button>
          </div>
          <div class="enrollment-subtab-panel active" id="enrollment-subtab-listing">
            <div class="grid">
              <div class="card fade-up delay-1" style="grid-column: span 12;">
              <div class="card-title">
                <h2>Next Semester Offerings</h2>
                <span class="chip" id="enrollmentSelectedCount">0 selected</span>
              </div>
              <p class="muted">
                Select offered courses. Each student slip will include only courses not yet passed.
                Remarks: <strong>New</strong> (never attempted), <strong>Repeat</strong> (attempted but not passed).
              </p>
              <p class="muted">Enrollment keys support manual edit and auto-generated 10-digit keys.</p>
              <div class="filter-row" style="margin-bottom: 12px;">
                <div class="field field-wide">
                  <label>Target Students</label>
                  <div class="filter-chip-group" id="enrollmentTargetModeButtons">
                    <button class="filter-chip active" type="button" id="enrollmentTargetAll" data-mode="all">All students</button>
                    <button class="filter-chip" type="button" id="enrollmentTargetIntakesMode" data-mode="groups">Specific groups</button>
                  </div>
                </div>
                <div class="field field-wide">
                  <label for="enrollmentTargetIntakes">Select Groups</label>
                  <select id="enrollmentTargetIntakes" multiple size="4"></select>
                  <div class="muted" id="enrollmentTargetHint">Select at least one group to enable course selection.</div>
                </div>
              </div>
              <div class="filter-row" style="margin-bottom: 12px;">
                <div class="field field-wide">
                  <label>Slip Locking</label>
                  <div class="form-actions" style="justify-content: flex-start; gap: 8px; flex-wrap: wrap;">
                    <button class="btn secondary small" type="button" id="btnEnrollmentLockGroups">Lock Selected Groups</button>
                    <button class="btn secondary small" type="button" id="btnEnrollmentUnlockGroups">Unlock Selected Groups</button>
                    <label class="inline-toggle" style="margin: 0;">
                      <input type="checkbox" id="enrollmentForceRebuildLocked" />
                      <span>Force rebuild locked slips</span>
                    </label>
                  </div>
                  <div class="muted" id="enrollmentLockHint">
                    Locked slips will not be reshuffled unless force rebuild is enabled.
                  </div>
                </div>
              </div>
              <div class="filter-row" style="margin-bottom: 12px;">
                <div class="field">
                  <label for="enrollmentMaxPerStudent">Max Courses / Student</label>
                  <input id="enrollmentMaxPerStudent" type="number" min="1" max="15" value="6" />
                </div>
                <div class="field field-wide">
                  <label>Priority Courses</label>
                  <div class="muted">
                    Mark priority directly on the course tiles. Earlier intake students are assigned first.
                  </div>
                </div>
              </div>
              <div class="import-row">
                <div id="enrollmentCourseGrid" class="enrollment-course-grid"></div>
              </div>
            <div class="muted">Minimum 1 and maximum 15 offered courses per build.</div>
              <div class="form-actions enrollment-top-actions">
                <button class="btn secondary small" type="button" id="btnEnrollmentSelectAll">Select all</button>
                <button class="btn secondary small" type="button" id="btnEnrollmentClearAll">Clear</button>
                <button class="btn small" type="button" id="btnEnrollmentBuild">Build Slips</button>
                <button class="btn secondary small" type="button" id="btnEnrollmentBulkPrint">Bulk Export (ZIP HTML)</button>
              </div>
            <div class="form-actions enrollment-key-bulk-actions">
              <button class="btn secondary small" type="button" id="btnEnrollmentGenerateAllKeys">Generate All Keys</button>
              <button class="btn secondary small" type="button" id="btnEnrollmentResetAllKeys">Reset All Keys</button>
            </div>
            <pre id="enrollmentBulkLog" aria-live="polite"></pre>
          </div>

              <div class="enrollment-layout" style="grid-column: span 12;">
                <div class="card enrollment-list-card fade-up delay-2">
                  <div class="card-title">
                    <h2>Student Enrollment List</h2>
                    <span class="chip" id="enrollmentStudentCount">0</span>
                  </div>
                    <div class="filter-row">
                      <div class="field field-wide">
                        <label for="enrollmentSearch">Search</label>
                        <input id="enrollmentSearch" type="text" placeholder="Search by student name or ID" />
                      </div>
                      <div class="field">
                        <label for="enrollmentListIntake">Intake</label>
                        <select id="enrollmentListIntake"></select>
                      </div>
                      <div class="field field-wide">
                        <label>Filter by enrolled course</label>
                        <div id="enrollmentCourseFilterButtons" class="filter-chip-group"></div>
                        <div class="muted" id="enrollmentCourseFilterHint">Click to toggle courses.</div>
                        <div class="muted" id="enrollmentCourseFilterEmpty" style="display: none;">
                          No offered courses selected.
                        </div>
                      </div>
                    </div>
                  <div id="enrollmentListEmpty" class="empty" style="margin-top: 12px;">No slips generated yet.</div>
                  <table id="enrollmentListTable" style="display: none;">
                    <thead>
                      <tr>
                        <th>Student ID</th>
                        <th>Name</th>
                        <th>Intake</th>
                        <th>Current Semester</th>
                        <th>Progress (90 Credits)</th>
                        <th>To Enroll</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody id="enrollmentListBody"></tbody>
                  </table>
                  <div class="form-actions" id="enrollmentPager" style="display: none; margin-top: 12px;">
                    <button class="btn secondary small" type="button" id="btnEnrollmentPrev">Previous</button>
                    <span class="muted" id="enrollmentPageMeta">Page 1 of 1</span>
                    <button class="btn secondary small" type="button" id="btnEnrollmentNext">Next</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="enrollment-subtab-panel" id="enrollment-subtab-stats">
            <div class="grid">
              <div class="card fade-up delay-2" style="grid-column: span 12;">
                <div class="card-title">
                  <h2>Enrollment Stats</h2>
                  <div class="header-actions">
                    <span class="chip" id="enrollmentStatsCourseCount">Courses: 0</span>
                    <span class="chip" id="enrollmentStatsStudentCount">Students: 0</span>
                  </div>
                </div>
                <div id="enrollmentStatsEmpty" class="empty" style="margin-top: 12px;">Build slips to see enrollment counts.</div>
                <table id="enrollmentStatsTable" style="display: none; margin-top: 12px;">
                  <thead>
                    <tr>
                      <th>Course Code</th>
                      <th>Title</th>
                      <th>Students</th>
                      <th>Repeat</th>
                    </tr>
                  </thead>
                  <tbody id="enrollmentStatsBody"></tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="enrollment-subtab-panel" id="enrollment-subtab-flags">
            <div class="grid">
              <div class="card fade-up delay-2" style="grid-column: span 12;">
                <div class="card-title">
                  <h2>Red Flag Students</h2>
                  <div class="header-actions">
                    <span class="chip" id="enrollmentRedFlagCount">0</span>
                  </div>
                </div>
                <div id="enrollmentRedFlagEmpty" class="empty" style="margin-top: 12px;">
                  No red flag students detected.
                </div>
                <table id="enrollmentRedFlagTable" style="display: none; margin-top: 12px;">
                  <thead>
                    <tr>
                      <th>Student ID</th>
                      <th>Name</th>
                      <th>Intake</th>
                      <th>Failed/No Mark</th>
                      <th>Reason</th>
                    </tr>
                  </thead>
                  <tbody id="enrollmentRedFlagBody"></tbody>
                </table>
              </div>
            </div>
          </div>
      </section>

      <section class="tab-panel" id="panel-reporting" role="tabpanel">
        <div class="grid">
          <div class="card fade-up delay-1" style="grid-column: span 12;">
            <div class="card-title">
              <h2>Reporting</h2>
              <span class="chip">CSV</span>
            </div>
            <div class="filter-row">
              <div class="field">
                <label for="reportType">Report</label>
                <select id="reportType">
                  <option value="students">Student List</option>
                </select>
              </div>
              <div class="field">
                <label for="reportIntake">Intake</label>
                <select id="reportIntake"></select>
              </div>
              <div class="field field-wide">
                <label for="reportCourse">Enrolled Course</label>
                <select id="reportCourse"></select>
                <div class="inline-toggle">
                  <label><input type="checkbox" id="reportIncludeCurrent" checked /> Current enrollment</label>
                  <label><input type="checkbox" id="reportIncludePast" checked /> Past results</label>
                </div>
              </div>
            </div>
            <div class="form-actions">
              <button class="btn" type="button" id="btnReportGenerate">Generate</button>
              <button class="btn secondary" type="button" id="btnReportDownload" disabled>Download CSV</button>
              <span class="muted" id="reportRowCount">0 rows</span>
            </div>
            <div id="reportPreviewEmpty" class="empty" style="margin-top: 12px;">
              Generate a report to preview the data.
            </div>
            <table id="reportPreviewTable" style="display: none; margin-top: 12px;">
              <thead id="reportPreviewHead"></thead>
              <tbody id="reportPreviewBody"></tbody>
            </table>
            <div class="form-actions" id="reportPager" style="display: none; margin-top: 12px;">
              <button class="btn secondary small" type="button" id="btnReportPrev">Previous</button>
              <span class="muted" id="reportPageMeta">Page 1 of 1</span>
              <button class="btn secondary small" type="button" id="btnReportNext">Next</button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div class="modal" id="resultSlipModal" aria-hidden="true">
      <div class="modal-card">
        <div class="slip-actions">
          <button class="btn secondary" type="button" id="btnCloseSlip">Close</button>
          <button class="btn" type="button" id="btnPrintSlip">Print Slip</button>
        </div>
        <div id="resultSlip" class="slip">
          <div class="slip-header">
            <div>
              <h3 class="slip-title">Academic Result Slip</h3>
              <div class="slip-brand">
                <strong id="slipInstitutionName">Centre of Digital and Flexible Learning</strong>
                <div id="slipInstitutionUnit">Innovative University College</div>
                <div id="slipInstitutionAddress">
                  Unit GL35, Main Lobby Block C, Kelana Square, Jalan SS 7/26,
                  47301 Petaling Jaya, Selangor
                </div>
              </div>
              <div class="slip-meta" id="slipStudentMeta"></div>
            </div>
            <div class="gpa-tag">CGPA: <span id="slipCGPA">--</span></div>
          </div>
          <div id="slipTerms"></div>
          <div class="slip-disclaimer">
            <strong>Disclaimer:</strong> This statement is not an official transcript. Any discrepancies
            should be reported to dbaodl.exam@innovative.edu.my.
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="enrollmentSlipModal" aria-hidden="true">
          <div class="modal-card">
          <div class="modal-header">
            <div>
              <h3 class="slip-title" style="margin: 0;">Enrollment Slip</h3>
              <div class="muted">Generated from selected offered courses.</div>
            </div>
            <div class="form-actions">
              <button class="btn secondary" type="button" id="btnEnrollmentLockSlip">Lock Slip</button>
              <button class="btn secondary" type="button" id="btnPrintEnrollmentSlip">Print Slip</button>
              <button class="btn secondary" type="button" id="btnCloseEnrollmentSlip">Close</button>
            </div>
          </div>
            <div id="enrollmentSlip" class="slip">
              <div class="card-title">
                <h2>Courses To Enroll</h2>
                <span class="chip" id="enrollmentSlipCount">0 course(s)</span>
              </div>
              <div class="slip-meta" id="enrollmentSlipStudentMeta">--</div>
              <div class="card" id="enrollmentCustomSection" style="margin-top: 12px;">
                <div class="card-title">
                  <h2>Customize Enrollment</h2>
                  <span class="chip" id="enrollmentCustomCount">0 selected</span>
                </div>
                <div class="muted" id="enrollmentCustomMeta">
                  Select up to the max per student from offered courses only.
                </div>
                <div id="enrollmentCustomList" class="enrollment-custom-list"></div>
                <div class="form-actions" style="margin-top: 10px;">
                  <button class="btn secondary small" type="button" id="btnEnrollmentCustomSelectAll">
                    Select all
                  </button>
                  <button class="btn secondary small" type="button" id="btnEnrollmentCustomClear">Clear</button>
                  <button class="btn small" type="button" id="btnEnrollmentCustomSave">Save Custom</button>
                  <button class="btn secondary small" type="button" id="btnEnrollmentCustomReset">
                    Reset to Auto
                  </button>
                  <span class="muted" id="enrollmentCustomStatus"></span>
                </div>
              </div>
          <table style="margin-top: 10px;">
            <thead>
              <tr>
                <th>Course Code</th>
              <th>Title</th>
              <th>Enrollment Key</th>
              <th>Remark</th>
            </tr>
          </thead>
          <tbody id="enrollmentSlipBody"></tbody>
        </table>
            <div class="slip-disclaimer">
              <strong>Declaration:</strong> I confirm that I have reviewed the courses listed above.
              Enrollment is subject to academic regulations, prerequisite checks, and final approval by
              the institution.
            </div>
          </div>
        </div>
      </div>

    <div class="modal" id="courseCoverageModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Course Coverage Detail</h3>
            <div class="muted" id="coverageCourseMeta">--</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnExportCoverage">Export CSV</button>
            <button class="btn secondary" type="button" id="btnCloseCoverage">Close</button>
          </div>
        </div>
        <div class="grid" style="grid-template-columns: repeat(12, minmax(0, 1fr)); gap: 12px;">
          <div class="card" style="grid-column: span 6;">
            <div class="card-title">
              <h2>Taken</h2>
              <span class="chip" id="coverageTakenCount">0</span>
            </div>
            <div id="coverageTakenList" class="muted"></div>
          </div>
          <div class="card" style="grid-column: span 6;">
            <div class="card-title">
              <h2>Not Taken</h2>
              <span class="chip" id="coverageNotTakenCount">0</span>
            </div>
            <div id="coverageNotTakenList" class="muted"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="resultPreviewModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Verify Upload</h3>
            <div class="muted">Select students to update</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnClosePreview">Close</button>
            <button class="btn secondary" type="button" id="btnSelectNonePreview">Select None</button>
            <button class="btn secondary" type="button" id="btnSelectAllPreview">Select All</button>
            <button class="btn" type="button" id="btnConfirmPreview">Confirm Update</button>
          </div>
        </div>
        <div class="card-title">
          <h2>Students Affected</h2>
          <span class="chip" id="resultPreviewCount">0</span>
        </div>
        <div id="resultPreviewEmpty" class="empty">No students detected.</div>
        <table id="resultPreviewTable" style="display: none;">
          <thead>
            <tr>
              <th></th>
              <th>Student ID</th>
              <th>Name</th>
              <th>Status</th>
              <th>New Rows</th>
            </tr>
          </thead>
          <tbody id="resultPreviewBody"></tbody>
        </table>
      </div>
    </div>

    <div class="modal" id="studentImportPreviewModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Verify Student Import</h3>
            <div class="muted">Select rows to import. Duplicate names are skipped unless explicitly updated.</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnCloseStudentImportPreview">Close</button>
            <button class="btn secondary" type="button" id="btnSelectNoneStudentImportPreview">Select None</button>
            <button class="btn secondary" type="button" id="btnSelectAllStudentImportPreview">Select All</button>
            <button class="btn" type="button" id="btnConfirmStudentImportPreview">Confirm Import</button>
          </div>
        </div>
        <div class="card-title">
          <h2>Rows Detected</h2>
          <span class="chip" id="studentImportPreviewCount">0</span>
        </div>
        <div id="studentImportPreviewEmpty" class="empty">No rows detected.</div>
        <table id="studentImportPreviewTable" style="display: none;">
          <thead>
            <tr>
              <th></th>
              <th>Row</th>
              <th>Student ID</th>
              <th>Name</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="studentImportPreviewBody"></tbody>
        </table>
      </div>
    </div>

    <div class="modal" id="studentEditModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Edit Student</h3>
            <div class="muted">Student ID cannot be changed.</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnCloseStudentEdit">Close</button>
            <button class="btn" type="button" id="btnSaveStudentEdit">Save</button>
          </div>
        </div>
        <div class="form-grid">
          <div class="field">
            <label for="editStudentId">Student ID</label>
            <input id="editStudentId" type="text" disabled />
          </div>
          <div class="field field-wide">
            <label for="editStudentName">Name</label>
            <input id="editStudentName" type="text" />
          </div>
          <div class="field">
            <label for="editStudentIc">IC</label>
            <input id="editStudentIc" type="text" />
          </div>
          <div class="field">
            <label for="editStudentIntake">Intake</label>
            <input id="editStudentIntake" type="text" />
          </div>
        </div>
      </div>
    </div>

    <div class="drawer" id="studentProfileDrawer" aria-hidden="true">
      <div class="drawer-panel">
        <div class="drawer-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Student Profile</h3>
            <div class="muted" id="studentProfileMeta">--</div>
          </div>
          <button class="btn secondary" type="button" id="btnCloseStudentProfile">Close</button>
        </div>
        <div id="studentProfileBody">
          <div class="card drawer-section">
            <h4>Personal Info</h4>
            <div class="muted" id="studentProfileInfo">Select a student to view details.</div>
          </div>
          <div class="card drawer-section">
            <h4>Result Summary</h4>
            <div class="muted" id="studentProfileSummary">--</div>
          </div>
          <div class="drawer-section">
            <div class="form-actions">
              <button class="btn secondary small" type="button" id="btnProfileResultSlip">Result Slip</button>
              <button class="btn secondary small" type="button" id="btnProfileEnrollmentSlip">Enrollment Slip</button>
                <button class="btn secondary small" type="button" id="btnProfileEdit">Save</button>
              <button class="btn secondary small" type="button" id="btnProfileDelete">Delete</button>
            </div>
            <div class="muted" id="studentProfileStatus" style="margin-top: 8px;">--</div>
          </div>
          <div class="card drawer-section">
            <h4>Deleted Students</h4>
            <div id="deletedStudentEmpty" class="empty">No deleted students.</div>
            <table id="deletedStudentTable" style="display: none; margin-top: 8px;">
              <thead>
                <tr>
                  <th>Student ID</th>
                  <th>Name</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="deletedStudentBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="markEditModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Edit Mark</h3>
            <div class="muted">Review the computed grade before saving.</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnCloseMarkEdit">Close</button>
            <button class="btn" type="button" id="btnConfirmMarkEdit" disabled>Confirm Save</button>
          </div>
        </div>
        <div class="mark-edit-grid">
          <div class="mark-edit-row">
            <span>Student</span>
            <strong id="markEditStudent">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Course</span>
            <strong id="markEditCourse">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Session</span>
            <strong id="markEditSession">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Semester</span>
            <strong id="markEditSemester">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Current Mark</span>
            <strong id="markEditCurrent">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>New Mark</span>
            <input id="markEditInput" class="mark-edit-input" type="number" min="0" max="100" step="0.01" />
          </div>
          <div class="mark-edit-row">
            <span>Letter</span>
            <strong id="markEditLetter">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Point</span>
            <strong id="markEditPoint">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Status</span>
            <strong id="markEditStatus">--</strong>
          </div>
        </div>
        <div class="mark-edit-warning" id="markEditWarning" style="display: none;"></div>
        <label class="mark-edit-verify">
          <input type="checkbox" id="markEditVerify" />
          I verify this mark is correct before saving.
        </label>
      </div>
    </div>

    <div class="modal" id="addResultModal" aria-hidden="true">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <h3 class="slip-title" style="margin: 0;">Add Result</h3>
            <div class="muted">Create a new result entry for this student.</div>
          </div>
          <div class="form-actions">
            <button class="btn secondary" type="button" id="btnCloseAddResult">Close</button>
            <button class="btn" type="button" id="btnConfirmAddResult" disabled>Save Result</button>
          </div>
        </div>
        <div class="mark-edit-grid">
          <div class="mark-edit-row">
            <span>Student</span>
            <strong id="addResultStudent">--</strong>
          </div>
          <div class="mark-edit-row">
            <span>Course</span>
            <select id="addResultCourse" class="mark-edit-input"></select>
          </div>
          <div class="mark-edit-row">
            <span>Session</span>
            <input id="addResultSession" class="mark-edit-input" type="text" placeholder="YYYY/MM" />
          </div>
          <div class="mark-edit-row">
            <span>Semester</span>
            <input id="addResultSemester" class="mark-edit-input" type="number" min="1" step="1" />
          </div>
          <div class="mark-edit-row">
            <span>Mark</span>
            <input id="addResultMark" class="mark-edit-input" type="number" min="0" max="100" step="0.01" />
          </div>
          <div class="mark-edit-row">
            <span>Letter</span>
            <strong id="addResultLetter">-</strong>
          </div>
          <div class="mark-edit-row">
            <span>Point</span>
            <strong id="addResultPoint">-</strong>
          </div>
          <div class="mark-edit-row">
            <span>Status</span>
            <strong id="addResultStatus">--</strong>
          </div>
        </div>
        <div class="mark-edit-warning" id="addResultWarning" style="display: none;"></div>
        <label class="mark-edit-verify">
          <input type="checkbox" id="addResultVerify" />
          I verify this result is correct before saving.
        </label>
      </div>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script type="module" src="./app/main.js"></script>
    <footer class="app-footer">Copyright MFR 2026</footer>
  </body>
</html>
